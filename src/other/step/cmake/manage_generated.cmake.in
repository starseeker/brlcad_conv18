# Inherit the parent CMake setting
set(CURRENT_SOURCE_DIR @CMAKE_CURRENT_SOURCE_DIR@)

# Include the file the provides the baseline against which
# current files will be compared
include(@BASELINE_INFORMATION_FILE@)

# Define a variety of convenience routines
include(@PROJECT_CMAKE_DIR@/Generated_Source_Utils.cmake)

# The following need to be checked:
#
# 1.  baseline input MD5 hashes against the current input
#     hashes.  If the cached sources were generated using
#     inputs other than the current inputs, note they are
#     out of sync but don't stop.  Templates used by perplex
#     and lemon are part of this group.
#
# 2.  baseline cached source MD5 hashes against current
#     cached source MD5 hashes.  Making sure no changes
#     have been made to the generated sources.  If the
#     cached sources need to be updated (see #1, for example)
#     their MD5 hashes need to be updated at the same time.
#
# 3.  MD5 hashes of output generated by the tools against
#     the MD5 hashes of the equalivent cached sources, if
#     a) the tool versions are the same b) the input MD5
#     hash comparisions were the same and c) the baseline
#     test from #2 passed.  This is done to detect platform
#     differences in output sources, but is only valid if
#     the input files are in their "pristine" state and the
#     toolchain is equalivent to that used for the baseline.

# Individually verify all of the files in question.
set(input_files "@INPUT_FILELIST@")
VERIFY_FILES("${input_files}" 0 input_unchanged)
set(template_files "@TEMPLATE_FILELIST@")
VERIFY_FILES("${template_files}" 1 templates_unchanged)
set(cached_files "@CACHED_FILELIST@")
VERIFY_FILES("${input_files}" 1 cached_unchanged)
if(NOT cached_unchanged)
    message(FATAL_ERROR "Cached generated sources do not match the MD5 hashes present in @BASELINE_INFORMATION_FILE@ - if updating cached sources, remember that the build enforces the requirement that associated MD5 hashes in @BASELINE_INFORMATION_FILE@ are current as well.  Cached generated sources should not be directly edited.")
endif(NOT cached_unchanged)

# Local Variables:
# tab-width: 8
# mode: cmake
# indent-tabs-mode: t
# End:
# ex: shiftwidth=2 tabstop=8
