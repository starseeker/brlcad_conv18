
# template Makefile used by the mkProbe script when run without the -i option.
# The destination for the generated Makefile will be in the file:
# ./$(SCHEMA_NAME)/Makefile

# ************  NOTE **********
######### YOU NEED TO CHANGE the values of the following macros 
# to work with your environment.
#
#  PDES_ROOT	location where SCL is installed
#  ARCH_ROOT	location for different object and library files 
#		(used to keep files generated by different compilers separate)
#  MAKE_RULES 	configuration for using different compilers

PDES_ROOT 	= @PDES_ROOT@
ARCH_ROOT	= $(PDES_ROOT)/@ARCH_ROOT@
MAKE_RULES 	= $(ARCH_ROOT)/make_rules

include $(MAKE_RULES)

#########  mkProbe SCRIPT MODIFIES the SCHEMA_NAME macro 
#########  DO NOT CHANGE NEXT LINE:

SCHEMA_NAME = your-schema
SCHEMA_DIR = .
SCHEMA_LIB_DIR = .

#########  the OFILES macro IS DEFINED IN THE make_schema FILE
#  generated by fedex_plus

include make_schema

##  END OUTSIDE VARIABLES **********

DATAPROBE_NAME = dp_$(SCHEMA_NAME)

DAI = $(PDES_ROOT)/src/cldai
CORE = $(PDES_ROOT)/src/clstepcore
SCL_EDITOR = $(PDES_ROOT)/src/cleditor
UTILS = $(PDES_ROOT)/src/clutils
IVFASD = $(PDES_ROOT)/src/clivfasd
PROBE_UI = $(PDES_ROOT)/src/clprobe-ui

PDESINCLUDES = -I$(ARCH_ROOT) \
		-I$(DAI) \
		-I$(SCL_EDITOR) \
		-I$(CORE) \
		-I$(UTILS)

SCHEMAINCLUDES = -I$(SCHEMA_DIR)

IVINCLUDES = -I$(IVFASD) \
		-I$(IV_INCLUDE_DIR)

PROBEINCLUDES = -I$(PROBE_UI)

# note MR_INCLUDES is from make_rules
INCLUDES = $(PROBEINCLUDES) \
	$(PDESINCLUDES) \
	$(SCHEMAINCLUDES) \
	$(MR_INCLUDES) \
	$(IVINCLUDES)

LIBPROBE = \
	-L$(ARCH_ROOT)/lib \
	-lCprobe-ui

LIBSCHEMA = \
	-L$(SCHEMA_LIB_DIR) \
	-lC$(SCHEMA_NAME)

LIBPDES = \
	-L$(ARCH_ROOT)/lib \
	-lCedcore \
	-lCdai \
	-lCutils \
	-lCivfasd

LIBINTERVIEWS = -L$(INTERVIEWS_LIB_DIR) $(INTERVIEWS_LIBS)

LIBS = $(LIBPROBE) $(LIBSCHEMA) $(LIBPDES) $(LIBINTERVIEWS) -lX11 -lm 

SCLLIBS = \
	$(LIBSCHEMA) \
	-L$(ARCH_ROOT)/lib \
	-lCedcore \
	-lCdai \
	-lCutils \
	-lm 

%.o:  $(SCHEMA_DIR)/%.cc
	@echo " "
	@echo "compiling $<"; 
	$(CXX) $(CFLAGS) $(INCLUDES) -c $< 

SRCS = $(SCHEMA_DIR)/*.cc
 
LIBRARY = $(SCHEMA_DIR)/libC$(SCHEMA_NAME).a

DP_LIBRARIES = \
	$(ARCH_ROOT)/lib/libCedcore.a \
	$(ARCH_ROOT)/lib/libCutils.a \
	$(LIBRARY) \
	$(ARCH_ROOT)/lib/libCprobe-ui.a \
	$(ARCH_ROOT)/lib/libCivfasd.a

all: time $(LIBRARY) $(DATAPROBE_NAME) p21

time:
	@date
	
lib:	$(LIBRARY)

$(LIBRARY): $(OFILES)
	@echo "making $(LIBRARY)"
	ar rc $(LIBRARY) $?
	ranlib $(LIBRARY)

probe: $(DATAPROBE_NAME)

$(DATAPROBE_NAME) :  $(DP_LIBRARIES)
	-@echo " "
	-@echo "making data probe ";
	-@echo " "
	$(CXX) -o $(DATAPROBE_NAME) \
	    $(ARCH_ROOT)/ofiles/probe-ui/probemain.o $(LIBS) $(LDFLAGS)
	@date

p21: $(ARCH_ROOT)/lib/p21read.o $(LIBRARY) $(SCL_LIBRARIES)
	-@echo " "
	-@echo "making Part 21 Reader ";
	-@echo " "
	$(CXX) -o p21read_$(SCHEMA_NAME)  \
	  $(ARCH_ROOT)/lib/p21read.o  \
	  $(ARCH_ROOT)/lib/needFunc.o  \
	  $(SCLLIBS) $(LDFLAGS)
	@date

depend:
	$(MAKE_DEPEND) $(INCLUDES) $(COND_DEFS) $(SRCS)

clean:
	rm -f $(OFILES)

#
# dependencies generated by makedepend
#

# DO NOT DELETE THIS LINE -- make depend depends on it.
