.TH SEARCH 1 BRL-CAD
.\"                       S E A R C H . 1
.\" BRL-CAD
.\"
.\" Copyright (c) 2008 United States Government as represented by
.\" the U.S. Army Research Laboratory.
.\"
.\" Redistribution and use in source (Docbook format) and 'compiled'
.\" forms (PDF, PostScript, HTML, RTF, etc), with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\"
.\" 1. Redistributions of source code (Docbook format) must retain the
.\" above copyright notice, this list of conditions and the following
.\" disclaimer.
.\"
.\" 2. Redistributions in compiled form (transformed to other DTDs,
.\" converted to PDF, PostScript, HTML, RTF, and other formats) must
.\" reproduce the above copyright notice, this list of conditions and
.\" the following disclaimer in the documentation and/or other
.\" materials provided with the distribution.
.\"
.\" 3. The name of the author may not be used to endorse or promote
.\" products derived from this documentation without specific prior
.\" written permission.
.\"
.\" THIS DOCUMENTATION IS PROVIDED BY THE AUTHOR AS IS'' AND ANY
.\" EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
.\" PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
.\" CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
.\" OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
.\" BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
.\" LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
.\" USE OF THIS DOCUMENTATION, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\".\".\"
.SH NAME
search \- find and list objects in a \fBBRL-CAD\fP database
.SH SYNOPSIS
.B search
[ path ]
[ options ... ]
.SH DESCRIPTION
.I search
works in a fashion similar to Unix-style find commands (internally it
is based on OpenBSD's and NetBSD's find code) but searches
.I objects
in the current open database in MGED rather than files in a
file system.  By default, the output is a list of matches printed
in the MGED command window, but other output options are available.
Matching of objects is done according to boolean expressions formed
using the
.B PRIMITIVES
and
.B OPERATORS
described below.
.LP
.SH PRIMITIVES:
.TP
.B attr attrib[=val]
Returns TRUE if the object has attribute
.I attrib.
If a specific value is also supplied for the attribute,
TRUE is returned if the object both has the attribute and
the attribute is set to value
.I val.
Both
.I attrib
and
.I val
are treated as patterns under shell pattern matching rules.
.TP
.B empty 
Returns TRUE if the object is a combination and has no tree below it.
.TP
.B iname pattern 
Like
.B name
except the match is case insensitive.
.TP
.B iregex pattern
Like
.B regex
except the match is case insensitive.
.TP
.B maxdepth n
True if the depth of the object in the tree is less than
or equal to
.I n.
.TP
.B mindepth n
True if the depth of the object in the gree is greater than
or equal to
.I n.
.TP
.B name pattern
True if the object name (not the full path, just the name) matches
.I pattern.
The evaluation is done according to shell pattern matching rules.
.TP
.B path pattern
True if the object path matches
.I pattern.
The evaluation is done according to shell pattern matching rules.
.TP
.B print 
Evaluates to TRUE - used to print out the path and name of the object.
.TP
.B print0 
Evaluates to TRUE - prints the pathname of the object to standard output, followed by an ASCII NUL character.
.TP
.B regex pattern
True if the object path matches
.I pattern.
Pattern evaluation is done using Regular Expression matching.
.TP
.B stdattr 
Returns TRUE if an object has ONLY standard attributes associated with it.  Standard attributes in BRL-CAD are:
.br
 
.br
.ta 1.5i
.br
aircode      GIFTmater      inherit
.br
los          material_id    oshader
.br
region       region_id      rgb
.br
 
.br
.TP
.B type pattern
Returns TRUE if the type of the object matches
.I pattern.
Pattern evaluation is done using shell pattern matching.  Types
recognized include:
.br
 
.br
.ta 1.5i
.br
.B Primitives
.br
arb4      arb5      arb6      arb7      arb8      arbn
.br
ars       bot       cline     dsp       ebm       ehy
.br
ell       epa       eto       extrude   grip      half
.br
hf        joint     nmg       part      pipe      poly
.br
rec       rhc       rpc       sketch    sph       spline
.br
submodel  tgc       tor       vol
.br

.br
.B Combinations
.br
Type             Abbreviations Recognized
.br
-----------      ------------------------
.br
combination      c, comb, combination
.br
region           r, reg, region
.br
assembly         a, assem, assembly
.br
nested region*   nr, nested_region
.br
 
.br
* Nested regions are cases where a region is used
in the subtree of another region - this is usually
a consequence of subtracting large geometries as a unit and
is considered poor modeling practice in BRL-CAD. If
a nested region is found, the top region is reported.
.LP
.SH OPERATORS
.TP
.B ( expression )
Evaluates to true if the expression inside the parenthesies evaluates to true.
Used to establish order of operations.
.TP
.B expression -and expression  (a.k.a -a)
The and operator operates like the logical AND operator - TRUE only if both
expressions are true.  AND is the default
operator assumed if two expressions are present with no operator explicitly
defined.
.TP
.B -not expression (a.k.a -!)
The logical NOT operator - returns the opposite of the evaluation result of
expression.
.TP
.B expression -or expression (a.k.a -o)
The logical OR operator - true if either expression is true.

.SH A Note on Expressions
All primaries and operands must be expressed as separate arguments to search.
In practice, this means that there must be a space between each element in a
search expression.  E.g. !(-name [a-z] -or -name [0-9]) must be written as:
.LP
! ( -name [a-z] -or -name [0-9] )
.LP
While this may seem like a rather verbose way of writing the expression, it greatly
simplifies the parsing of the expression and is standard for virtually all
.B find
type commands. Because [a-z] and [0-9] are atomic arguments as far as search is concerned, they should NOT be expanded in a similar fashion.

.SH EXAMPLES
The following are run from the MGED command prompt:
.TP
search -name *.s
Find all instances of objects in the database with names ending in ".s"
.TP
search -name *.s -mindepth 3
Find all instances of objects in the database with names ending in ".s"
that are 3 or more levels deep in their tree.
.TP
search . -type eto
Find all objects in the database that are elliptical tori.  Notice the
use of "." for the path, which means to find the objects themselves in
a flat search rather than all instances in the tree hierarchy.
.TP
search -type comb -not ( -type region -or -type assem )
Find all instances of combinations that are not regions and do not contain regions.

.SH DIAGNOSTICS
Errors will be returned if parsing of the arguments fails, or one of the primaries's
evaluation functions returns an error.
.SH COPYRIGHT
This software is Copyright (c) 2008 United States Government as
represented by the U.S. Army Research Laboratory. All rights reserved.
Portions Copyright 1990, 1993, 1994 The Regents of the University of California,
per copyright and license information from OpenBSD and NetBSD.
.SH BUGS
Bugs resulting from incorrect parsing of shell pattern expressions are the
result of libbu's fnmatch.
.SH "BUG REPORTS"
Reports of bugs or problems should be submitted via electronic
mail to <devs@brlcad.org>, or via the "cadbug.sh" script.
