<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- lifted from troff+man+tkman by doclifter -->
<refentry xmlns='http://docbook.org/ns/docbook' version='5.0' xml:lang='en' xml:id='crtselhdlr3'>

<!-- '\" Copyright (c) 1990\-1994 The Regents of the University of California.
'\" Copyright (c) 1994\-1996 Sun Microsystems, Inc. -->

<!-- '\" See the file "license.terms" for information on usage and redistribution
'\" of this file, and for a DISCLAIMER OF ALL WARRANTIES.
'\" 
'\" RCS: @(#) $Id$
'\"  -->
<refentryinfo><date>4.0</date></refentryinfo>
<refmeta>
<refentrytitle>Tk_CreateSelHandler</refentrytitle>
<manvolnum>3</manvolnum>
<refmiscinfo class='date'>4.0</refmiscinfo>
<refmiscinfo class='source'>Tk</refmiscinfo>
<refmiscinfo class='manual'>Tk Library Procedures</refmiscinfo>
</refmeta>
<refnamediv>
<refname>Tk_CreateSelHandler</refname>
<refname>Tk_DeleteSelHandler</refname>
<refpurpose>arrange to handle requests for a selection</refpurpose>
</refnamediv>
<!-- body begins here -->
<refsynopsisdiv xml:id='synopsis'>
<funcsynopsis>
<funcsynopsisinfo>
#include &lt;tk.h&gt;

</funcsynopsisinfo>
<funcprototype>
<funcdef><function>Tk_CreateSelHandler</function></funcdef>
<paramdef><parameter>tkwin</parameter></paramdef>
<paramdef><parameter>selection</parameter></paramdef>
<paramdef><parameter>target</parameter></paramdef>
<paramdef><parameter>proc</parameter></paramdef>
<paramdef><parameter>clientData</parameter></paramdef>
<paramdef><parameter>format</parameter></paramdef>
</funcprototype>
<funcprototype>
<funcdef><function>Tk_DeleteSelHandler</function></funcdef>
<paramdef><parameter>tkwin</parameter></paramdef>
<paramdef><parameter>selection</parameter></paramdef>
<paramdef><parameter>target</parameter></paramdef>
</funcprototype>
</funcsynopsis>
</refsynopsisdiv>


<refsect1 xml:id='arguments'><title>ARGUMENTS</title>
<!-- .AS Tk_SelectionProc clientData -->
<informaltable>
<tgroup cols='3'>
<tbody>

<row><entry>"Tk_Window"</entry><entry>"tkwin"</entry><entry>"in"</entry>
<entry>
<para>Window for which <emphasis remap='I'>proc</emphasis> will provide selection information.</para>
</entry>
</row>
<row><entry>Atom</entry><entry>selection</entry><entry>in</entry>
<entry>
<para>The name of the selection for which <emphasis remap='I'>proc</emphasis> will provide
selection information.</para>
</entry>
</row>
<row><entry>Atom</entry><entry>target</entry><entry>in</entry>
<entry>
<para>Form in which <emphasis remap='I'>proc</emphasis> can provide the selection (e.g. STRING
or FILE_NAME).  Corresponds to <emphasis remap='I'>type</emphasis> arguments in <emphasis remap='B'>selection</emphasis>
commands.</para>
</entry>
</row>
<row><entry>Tk_SelectionProc</entry><entry>*proc</entry><entry>in</entry>
<entry>
<para>Procedure to invoke whenever the selection is owned by <emphasis remap='I'>tkwin</emphasis>
and the selection contents are requested in the format given by
<emphasis remap='I'>target</emphasis>.</para>
</entry>
</row>
<row><entry>ClientData</entry><entry>clientData</entry><entry>in</entry>
<entry>
<para>Arbitrary one-word value to pass to <emphasis remap='I'>proc</emphasis>.</para>
</entry>
</row>
<row><entry>Atom</entry><entry>format</entry><entry>in</entry>
<entry>
<para>If the selection requestor is not in this process, <emphasis remap='I'>format</emphasis> determines
the representation used to transmit the selection to its
requestor.</para>
<!-- .BE -->
</entry>
</row>
</tbody>
</tgroup>
</informaltable>

</refsect1>

<refsect1 xml:id='description'><title>DESCRIPTION</title>
<para><function>Tk_CreateSelHandler</function> arranges for a particular procedure
(<emphasis remap='I'>proc</emphasis>) to be called whenever <emphasis remap='I'>selection</emphasis> is owned by
<emphasis remap='I'>tkwin</emphasis> and the selection contents are requested in the
form given by <emphasis remap='I'>target</emphasis>. 
<emphasis remap='I'>Target</emphasis> should be one of
the entries defined in the left column of Table 2 of the
X Inter-Client Communication Conventions Manual (ICCCM) or
any other form in which an application is willing to present
the selection.  The most common form is STRING.</para>

<para><emphasis remap='I'>Proc</emphasis> should have arguments and result that match the
type <type>Tk_SelectionProc</type>:</para>
<programlisting remap='CS'>
<funcsynopsis>
<funcprototype>
<funcdef>typedef int <function>Tk_SelectionProc</function></funcdef>
    <paramdef>ClientData <parameter>clientData</parameter></paramdef>
    <paramdef>int <parameter>offset</parameter></paramdef>
    <paramdef>char * <parameter>buffer</parameter></paramdef>
    <paramdef>int <parameter>maxBytes</parameter></paramdef>
</funcprototype>
</funcsynopsis>
</programlisting> <!-- remap='CE' -->
<para>The <varname role='parameter'>clientData</varname> parameter to <emphasis remap='I'>proc</emphasis> is a copy of the
<varname role='parameter'>clientData</varname> argument given to <function>Tk_CreateSelHandler</function>.
Typically, <varname role='parameter'>clientData</varname> points to a data
structure containing application-specific information that is
needed to retrieve the selection.  <emphasis remap='I'>Offset</emphasis> specifies an
offset position into the selection, <varname role='parameter'>buffer</varname> specifies a
location at which to copy information about the selection, and
<varname role='parameter'>maxBytes</varname> specifies the amount of space available at
<varname role='parameter'>buffer</varname>.  <emphasis remap='I'>Proc</emphasis> should place a NULL-terminated string
at <varname role='parameter'>buffer</varname> containing <varname role='parameter'>maxBytes</varname> or fewer characters
(not including the terminating NULL), and it should return a
count of the number of non-NULL characters stored at
<varname role='parameter'>buffer</varname>.  If the selection no longer exists (e.g. it once
existed but the user deleted the range of characters containing
it), then <emphasis remap='I'>proc</emphasis> should return -1.</para>

<para>When transferring large selections, Tk will break them up into
smaller pieces (typically a few thousand bytes each) for more
efficient transmission.  It will do this by calling <emphasis remap='I'>proc</emphasis>
one or more times, using successively higher values of <varname role='parameter'>offset</varname>
to retrieve successive portions of the selection.  If <emphasis remap='I'>proc</emphasis>
returns a count less than <varname role='parameter'>maxBytes</varname> it means that the entire
remainder of the selection has been returned.  If <emphasis remap='I'>proc</emphasis>'s return
value is <varname role='parameter'>maxBytes</varname> it means there may be additional information
in the selection, so Tk must make another call to <emphasis remap='I'>proc</emphasis> to
retrieve the next portion.</para>

<para><emphasis remap='I'>Proc</emphasis> always returns selection information in the form of a
character string.  However, the ICCCM allows for information to
be transmitted from the selection owner to the selection requestor
in any of several formats, such as a string, an array of atoms, an
array of integers, etc.  The <emphasis remap='I'>format</emphasis> argument to
<function>Tk_CreateSelHandler</function> indicates what format should be used to
transmit the selection to its requestor (see the middle column of
Table 2 of the ICCCM for examples).  If <emphasis remap='I'>format</emphasis> is not
STRING, then Tk will take the value returned by <emphasis remap='I'>proc</emphasis> and divided
it into fields separated by white space.  If <emphasis remap='I'>format</emphasis> is ATOM,
then Tk will return the selection as an array of atoms, with each
field in <emphasis remap='I'>proc</emphasis>'s result treated as the name of one atom.  For
any other value of <emphasis remap='I'>format</emphasis>, Tk will return the selection as an
array of 32-bit values where each field of <emphasis remap='I'>proc</emphasis>'s result is
treated as a number and translated to a 32-bit value.  In any event,
the <emphasis remap='I'>format</emphasis> atom is returned to the selection requestor along
with the contents of the selection.</para>

<para>If <function>Tk_CreateSelHandler</function> is called when there already exists a
handler for <emphasis remap='I'>selection</emphasis> and <emphasis remap='I'>target</emphasis> on <emphasis remap='I'>tkwin</emphasis>, then the
existing handler is replaced with a new one.</para>

<para><function>Tk_DeleteSelHandler</function> removes the handler given by <emphasis remap='I'>tkwin</emphasis>,
<emphasis remap='I'>selection</emphasis>, and <emphasis remap='I'>target</emphasis>, if such a handler exists.
If there is no such handler then it has no effect.</para>

</refsect1>

<refsect1 xml:id='keywords'><title>KEYWORDS</title>
<para>format, handler, selection, target</para>
</refsect1>
</refentry>

