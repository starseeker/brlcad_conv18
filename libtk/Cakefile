/*
 *			libtk/Cakefile
 */
#define SRCDIR	libtk
#define	SRCSUFF	.c
#define MANSECTION	3

#include "../Cakefile.defs"

#if defined( NFS )
#define TCL_DIR	.libtcl.MTYPE
#else
#define TCL_DIR	libtcl
#endif

#if !defined(BUILD_LIBRARY)
#define TK_OPTS	--srcdir=[[pwd]]/../SRCDIR/"unix" --cache-file cache.MTYPE \
			 --exec-prefix=/usr/brlcad --prefix=/usr/brlcad \
			 --with-tcl=../TCL_DIR
#define PRODUCTS	libtk.a wish
#define	AFTER_MAKE	/**/
#else
#define TK_OPTS	--srcdir=[[pwd]]/../SRCDIR/"unix" --enable-shared \
			 --cache-file cache.MTYPE --exec-prefix=/usr/brlcad --prefix=/usr/brlcad \
			 --with-tcl=../TCL_DIR
#define PRODUCTS	libtk.so wish
#define	SHARED_PRODUCT  libtk.so''[[LIBVERS]]
#define	AFTER_MAKE	mv libtk.so SHARED_PRODUCT ; sharedliblink.sh SHARED_PRODUCT
#endif

PRODUCTS: Makefile.MTYPE cache.MTYPE
	make -f Makefile.MTYPE
	AFTER_MAKE

Makefile.MTYPE cache.MTYPE:		if not exist Makefile.MTYPE or not exist cache.MTYPE
	( \C\F\L\A\G\S=\"GFLAG OPTIMIZER PROFILER -DTK_NO_SECURITY\"; \
		\R\A\N\L\I\B=\"RANLIB\";\
		\L\D\F\L\A\G\S=\"LDFLAGS\"; \
		 export \C\F\L\A\G\S \R\A\N\L\I\B \L\D\F\L\A\G\S; \
		 ../SRCDIR/"unix"/configure TK_OPTS; \
		../SRCDIR/fix_makefile.sh > Makefile.MTYPE)

clean&:
	make -f Makefile.MTYPE clean

noprod&:
	rm -rf *.so *.a

clobber&: Makefile.MTYPE
	make -f Makefile.MTYPE clean
	rm -f *.MTYPE

install&: Makefile.MTYPE
	make -f Makefile.MTYPE install

install-nobak&: Makefile.MTYPE
	make -f Makefile.MTYPE install

tktest: Makefile.MTYPE
	make -f Makefile.MTYPE tktest

test&: Makefile.MTYPE
	make -f Makefile.MTYPE test

/* dltest:			if not exist dltest
	cp -r ../SRCDIR/"unix"/dltest .
*/
